<?php

namespace App\Http\Controllers;

use App\Models\User;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Hash;

class DangnhapController extends Controller
{
    //
    function dangnhap(){
        return view('auth.dangnhap');
        
    }

    function dangnhappost(Request $request){
        $request -> validate([
            'email' =>'required|email',
            'password' => 'required|min:6'
        ]);
        $credentials = $request -> only('email', 'password');
        if(Auth::attempt($credentials)){
            return redirect()->route('home')->with('success', 'Đăng nhập thành công');
        }else{
            return redirect()->back()->with('error', 'Tài khoản hoặc mật khẩu không chính xác');
        } 
    }

    function dangky(){
        return view('auth.dangky');
    }

    function dangkypost(Request $request){
        $request -> validate([
            'fullname' =>'required',
            'email' =>'required',
            'password' => 'required',
        ]);

        $user = new User();
        $user -> name = $request -> fullname;
        $user -> email = $request -> email;
        $user -> password = Hash::make($request -> password);
        if ($user -> save()){
            return redirect()->route('login')->with('success', 'Đăng ký thành công');
        }
        else{
            return redirect(route('register'))->with('error', 'Đăng ký thất bại');
        }

        
    }
}
